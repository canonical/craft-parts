name: QA
on:
  push:
    branches:
      - "main"
      - "feature/*"
      - "hotfix/*"
      - "release/*"
      - "renovate/*"
  pull_request:

jobs:
  lint:
    uses: canonical/starflow/.github/workflows/lint-python.yaml@main
  test:
    uses: canonical/starflow/.github/workflows/test-python.yaml@work/setup-vars
    with:
      fast-test-platforms: '["ubuntu-22.04", "ubuntu-24.04"]'
      fast-test-python-versions: '["3.10", "3.12", "3.13"]'
      slow-test-platforms: '["ubuntu-24.04"]'
      slow-test-python-versions: '["3.12"]'
      lowest-python-version: ""
      pytest-markers: not java and not python
      setup-vars: NO_JAVA=1 NO_PYTHON=1
  test-java-plugins:
    uses: canonical/starflow/.github/workflows/test-python.yaml@work/setup-vars
    with:
      fast-test-platforms: "[]"
      slow-test-platforms: '["ubuntu-24.04"]'
      slow-test-python-versions: '["3.12"]'
      lowest-python-version: ""
      pytest-markers: java
      setup-vars: NO_PYTHON=1
  test-python-plugins:
    uses: canonical/starflow/.github/workflows/test-python.yaml@work/setup-vars
    with:
      fast-test-platforms: "[]"
      slow-test-platforms: '["ubuntu-24.04"]'
      slow-test-python-versions: '["3.12"]'
      lowest-python-version: ""
      pytest-markers: python
      setup-vars: NO_JAVA=1
